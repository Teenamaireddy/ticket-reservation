<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RailNexus | Enterprise Railway Management System</title>
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@300;400;600;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary: #0f172a;
            --accent: #2563eb;
            --gold: #f59e0b;
            --success: #10b981;
            --danger: #ef4444;
            --bg: #f8fafc;
            --sidebar-width: 260px;
        }

        /* DARK MODE SUPPORT */
        body.dark-theme { --bg: #0f172a; color: #f8fafc; }
        body.dark-theme .glass-card, body.dark-theme header { background: #1e293b; border-color: #334155; color: white; }
        body.dark-theme input, body.dark-theme select { background: #334155; border-color: #475569; color: white; }
        body.dark-theme .nav-item.active { background: rgba(255,255,255,0.1); }

        * { box-sizing: border-box; margin: 0; padding: 0; font-family: 'Plus Jakarta Sans', sans-serif; }
        body { background: var(--bg); display: flex; height: 100vh; width: 100vw; overflow: hidden; color: #1e293b; transition: 0.3s; }

        /* IMPROVED SIDEBAR */
        aside { 
            width: var(--sidebar-width); 
            background: var(--primary); 
            color: white; 
            padding: 20px; 
            display: flex; 
            flex-direction: column; 
            z-index: 1000; 
            height: 100%;
            flex-shrink: 0;
            overflow-y: auto;
            scrollbar-width: none;
        }
        aside::-webkit-scrollbar { display: none; }

        .brand { font-size: 24px; font-weight: 800; color: var(--accent); margin-bottom: 30px; display: flex; align-items: center; justify-content: center; }
        .nav-group { flex: 1; }
        .nav-item { 
            padding: 14px; 
            border-radius: 12px; 
            display: flex; 
            align-items: center; 
            gap: 15px; cursor: pointer; transition: 0.3s; color: #94a3b8; font-weight: 600; margin-bottom: 8px; }
        .nav-item:hover, .nav-item.active { background: rgba(255,255,255,0.1); color: white; }

        main { flex: 1; overflow-y: auto; position: relative; display: flex; flex-direction: column; height: 100%; }
        
        header { 
            background: white; 
            padding: 15px 25px; 
            display: flex; 
            justify-content: space-between; 
            align-items: center; 
            border-bottom: 1px solid #e2e8f0; 
            position: sticky; 
            top: 0; 
            z-index: 100; 
        }

        .container { padding: 20px; max-width: 1200px; margin: 0 auto; width: 100%; }
        .glass-card { background: white; border-radius: 24px; padding: 20px; border: 1px solid #e2e8f0; box-shadow: 0 10px 15px -3px rgba(0,0,0,0.04); margin-bottom: 25px; }
        
        .train-card { display: flex; flex-wrap: wrap; justify-content: space-between; align-items: center; padding: 15px; border-bottom: 1px solid #f1f5f9; gap: 15px; }
        .passenger-form { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-top: 20px; }
        @media (max-width: 768px) { .passenger-form { grid-template-columns: 1fr; } }

        .checkout-bar { display: flex; justify-content: space-between; align-items: center; margin-top: 25px; gap: 15px; flex-wrap: wrap; }
        @media (max-width: 500px) { .checkout-bar { flex-direction: column; align-items: stretch; } }

        .btn-prime { background: var(--accent); color: white; border: none; padding: 12px 20px; border-radius: 12px; font-weight: 700; cursor: pointer; transition: 0.3s; display: inline-flex; align-items: center; justify-content: center; gap: 8px; font-size: 14px; white-space: nowrap; }
        .btn-prime:hover { transform: translateY(-2px); box-shadow: 0 10px 15px -3px rgba(37, 99, 235, 0.4); }
        .btn-back { background: #f1f5f9; color: #475569; border: none; padding: 8px 15px; border-radius: 8px; cursor: pointer; font-weight: 600; margin-bottom: 15px; display: inline-flex; align-items: center; gap: 5px; }

        .stepper { display: flex; justify-content: space-between; margin-bottom: 30px; position: relative; }
        .stepper::before { content: ''; position: absolute; top: 15px; left: 0; width: 100%; height: 2px; background: #e2e8f0; z-index: 1; }
        .step { position: relative; z-index: 2; background: var(--bg); padding: 0 5px; display: flex; flex-direction: column; align-items: center; gap: 8px; font-size: 10px; font-weight: 800; color: #94a3b8; }
        .step.active { color: var(--accent); }
        .step.active span { background: var(--accent); border-color: var(--accent); color: white; }
        .step span { width: 28px; height: 28px; border-radius: 50%; border: 2px solid #cbd5e1; background: white; display: grid; place-items: center; }

        .view { display: none; animation: fadeIn 0.4s ease forwards; }
        .view.active { display: block; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

        .coach-container { background: #1e293b; padding: 25px; border-radius: 20px; overflow-x: auto; display: flex; gap: 15px; border: 6px solid #334155; margin-bottom: 20px; }
        .berth-group { display: flex; flex-direction: column; gap: 10px; }
        .berth { width: 50px; height: 40px; background: white; border-radius: 6px; display: grid; place-items: center; font-size: 10px; font-weight: 800; cursor: pointer; color: #1e293b; }
        .berth.selected { background: var(--gold); color: white; }
        .berth.booked { background: #475569; color: #94a3b8; cursor: not-allowed; }

        .meal-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 15px; margin-top: 20px; }
        .meal-card { background: white; border: 1px solid #e2e8f0; border-radius: 15px; padding: 15px; text-align: center; transition: 0.3s; cursor: pointer; }
        .meal-card img { width: 100%; height: 100px; object-fit: cover; border-radius: 10px; margin-bottom: 10px; }

        .track-path { border-left: 4px solid #e2e8f0; margin-left: 20px; padding: 20px 0; }
        .track-point { position: relative; padding-left: 30px; margin-bottom: 40px; }
        .track-point::before { content: ''; position: absolute; left: -10px; top: 0; width: 16px; height: 16px; background: white; border: 3px solid var(--accent); border-radius: 50%; }
        .track-point.active::before { background: var(--gold); border-color: var(--gold); animation: pulse 1.5s infinite; }
        @keyframes pulse { 0% { opacity: 1; } 50% { opacity: 0.4; } 100% { opacity: 1; } }

        .overlay { position: fixed; inset: 0; background: rgba(15,23,42,0.9); z-index: 5000; display: none; flex-direction: column; align-items: center; justify-content: center; color: white; }
        .spinner { width: 50px; height: 50px; border: 5px solid #ffffff22; border-top-color: var(--accent); border-radius: 50%; animation: spin 1s linear infinite; }
        @keyframes spin { to { transform: rotate(360deg); } }

        .final-ticket { max-width: 500px; margin: 20px auto; background: white; border-radius: 24px; overflow: hidden; box-shadow: 0 20px 40px rgba(0,0,0,0.1); border: 1px solid #e2e8f0; color: #1e293b; }
        .ticket-header { background: var(--primary); color: white; padding: 20px; text-align: center; }
        
        .form-group label { display: block; margin-bottom: 5px; font-weight: 600; font-size: 12px; }
        .form-group input, select { width: 100%; padding: 12px; border-radius: 10px; border: 1px solid #ddd; outline: none; background: white; color: #1e293b; }

        .setting-row { display: flex; justify-content: space-between; align-items: center; padding: 15px 0; border-bottom: 1px solid #f1f5f9; }
        .switch { position: relative; display: inline-block; width: 45px; height: 22px; }
        .switch input { opacity: 0; width: 0; height: 0; }
        .slider { position: absolute; cursor: pointer; inset: 0; background-color: #cbd5e1; transition: .4s; border-radius: 24px; }
        .slider:before { position: absolute; content: ""; height: 14px; width: 14px; left: 4px; bottom: 4px; background-color: white; transition: .4s; border-radius: 50%; }
        input:checked + .slider { background-color: var(--accent); }
        input:checked + .slider:before { transform: translateX(23px); }
        
        .tbs { background: var(--accent); color: white; transition: 0.3s; }
        .tbs:hover { background: white; color: var(--accent); box-shadow: 0 0 0 4px rgba(37, 99, 235, 0.2); }
    </style>
</head>
<body onload="setupMinDate()">

    <div id="globalLoader" class="overlay">
        <div class="spinner"></div>
        <h2 id="loaderText" style="margin-top:20px;">Securing Connection...</h2>
    </div>

    <aside id="sidebar">
        <div class="brand">
            <img height="60" width="100" src="djgst_logo.png" alt="Logo" style="object-fit: contain;">
        </div>
        <div class="nav-group">
            <div class="nav-item active" onclick="navigate('booking-module')"><i class="fa fa-ticket"></i> Book Reservation</div>
            <div class="nav-item" onclick="navigate('status-module')"><i class="fa fa-map-location-dot"></i> Live Tracking</div>
            <div class="nav-item" onclick="navigate('food-module')"><i class="fa fa-utensils"></i> Order Meals</div>
            <div class="nav-item" onclick="navigate('history-module')"><i class="fa fa-history"></i> My Bookings</div>
        </div>
        <div class="nav-item" onclick="navigate('settings-module')" style="margin-top: 20px;"><i class="fa fa-gear"></i> System Settings</div>
    </aside>

    <main>
        <header>
            <div><h3 id="headerTitle" style="font-size: 18px; font-weight: 800; color: var(--primary);">BOOKING</h3></div>
            <div style="display:flex; align-items:center; gap:12px;">
                <span style="font-size:12px; font-weight:700;" id="userDisplay">Aman Sharma</span>
                <div id="userInitial" style="width:32px; height:32px; background:var(--accent); color:white; border-radius:50%; display:grid; place-items:center; font-size:12px; font-weight:bold;">AS</div>
            </div>
        </header>

        <div class="container">
            <section id="booking-module" class="view active">
                <div class="stepper">
                    <div class="step active" id="step1"><span>1</span> Search</div>
                    <div class="step" id="step2"><span>2</span> Trains</div>
                    <div class="step" id="step3"><span>3</span> Berths</div>
                    <div class="step" id="step4"><span>4</span> Payment</div>
                    <div class="step" id="step5"><span>5</span> Ticket</div>
                </div>

                <div id="bk-search" class="view active">
                    <div class="glass-card">
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px;">
                            <div class="form-group"><label>From</label><input type="text" id="src" value="Delhi"></div>
                            <div class="form-group"><label>To</label><input type="text" id="dest" value="Mumbai"></div>
                            <div class="form-group"><label>Date</label><input type="date" id="jDate"></div>
                            <button class="btn-prime" style="height:45px; margin-top:22px;" onclick="searchTrains()">Search Trains</button>
                        </div>
                    </div>
                </div>

                <div id="bk-results" class="view">
                    <button class="btn-back" onclick="goBack('bk-search', 1)"><i class="fa fa-arrow-left"></i> Change Search</button>
                    <div class="glass-card" style="padding:0;">
                        <div class="train-card">
                            <div class="train-info">
                                <b>12952 - RAJDHANI EXP</b><br>
                                <small>Daily | 16:30 - 08:35</small></div><div class="train-actions">
                                <button class="tbs btn-prime" onclick="selectTrain('3rd AC', 2480)">3A - ₹2480</button><br><br>
                                <button class="tbs btn-prime" onclick="selectTrain('2nd AC', 4100)">2A - ₹4100</button>
                            </div>
                        </div>
                    </div>
                </div>

                <div id="bk-berths" class="view">
                    <button class="btn-back" onclick="goBack('bk-results', 2)"><i class="fa fa-arrow-left"></i> Change Train</button>
                    <div class="glass-card">
                        <h3>Coach B4 - Layout</h3>
                        <div class="coach-container" id="coachMap"></div>
                        <div class="passenger-form">
                            <div class="form-group"><label>Passenger Name</label><input type="text" id="passName" placeholder="Enter Name" oninput="updateUserProfile(this.value)"></div>
                            <div class="form-group"><label>Email Address</label><input type="email" id="passEmail" placeholder="Enter Email"></div>
                        </div>
                        <div class="checkout-bar">
                            <div><p style="font-size:12px;">Selected: <b id="selBerths">None</b></p><h2 id="totalFare">₹0</h2></div>
                            <button class="btn-prime" id="berthContinue" disabled onclick="toCheckout()">Confirm & Checkout</button>
                        </div>
                    </div>
                </div>

                <div id="bk-pay" class="view">
                    <button class="btn-back" onclick="goBack('bk-berths', 3)"><i class="fa fa-arrow-left"></i> Modify Berths</button>
                    <div class="glass-card"><h3>Payment Summary</h3><div id="invoiceContent" style="margin:20px 0;"></div><button class="btn-prime" style="width:100%; justify-content:center;" onclick="runPayment()">PROCESS PAYMENT</button></div>
                </div>

                <div id="bk-ticket" class="view">
                    <button class="btn-back" onclick="navigate('booking-module')"><i class="fa fa-home"></i> New Booking</button>
                    <div class="glass-card" style="text-align:center;">
                        <i class="fa fa-check-circle" style="font-size:60px; color:var(--success);"></i>
                        <h2 style="margin:15px 0;">Booking Confirmed!</h2>
                        <div style="display: flex; gap: 10px; justify-content: center; flex-wrap: wrap;">
                            <button class="btn-prime" onclick="showTicketUI()">View E-Ticket</button>
                            <button class="btn-prime" style="background: var(--primary);" onclick="downloadTicket()"><i class="fa fa-download"></i> Download</button>
                        </div>
                    </div>
                    <div class="final-ticket" id="ticketVisual" style="display:none;">
                        <div class="ticket-header"><h3 id="t_train">--</h3></div>
                        <div style="padding:20px;">
                            <div style="display:flex; justify-content:space-between; margin-bottom:15px;">
                                <div><small>PNR</small><br><b id="t_pnr">--</b></div>
                                <div><small>DATE</small><br><b id="t_date">--</b></div>
                            </div>
                            <div style="margin-bottom:15px; padding-bottom:10px; border-bottom: 1px dashed #ddd;">
                                <small>JOURNEY</small><br>
                                <b id="t_route">-- to --</b>
                            </div>
                            <p>Passenger: <b id="t_passName">--</b></p>
                            <p>Email: <b id="t_passEmail">--</b></p>
                            <p>Seats: <b id="t_seats">--</b></p>
                        </div>
                    </div>
                </div>
            </section>

            <section id="status-module" class="view">
                <button class="btn-back" onclick="navigate('booking-module')"><i class="fa fa-arrow-left"></i> Dashboard</button>
                <div class="glass-card">
                    <h3>Live Train Status</h3>
                    <div class="track-path">
                        <div class="track-point"><b id="trackSrc">Delhi</b><br><small>Departed at 16:30</small></div>
                        <div class="track-point active"><b>Midway Station</b><br><small>Approaching - On Time</small></div>
                        <div class="track-point"><b id="trackDest">Mumbai</b><br><small>Expected 08:35</small></div>
                    </div>
                </div>
            </section>

            <section id="food-module" class="view">
                <button class="btn-back" onclick="navigate('booking-module')"><i class="fa fa-arrow-left"></i> Dashboard</button>
                <div class="glass-card"><h3>E-Catering Menu</h3>
                    <div class="meal-grid">
                        <div class="meal-card" onclick="addFood('Executive Thali')">
                            <img src="https://images.unsplash.com/photo-1546833999-b9f581a1996d?auto=format&fit=crop&w=400" alt="Thali">
                            <b>Executive Thali</b><br><small>₹240</small>
                        </div>
                        <div class="meal-card" onclick="addFood('Veg Biryani')">
                            <img src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcTupm1r7DOk3bHIGlaeKsxuOEIdjRXiF6_rkHiLQo0iDw&s=10" alt="Biryani">
                            <b>Veg Biryani</b><br><small>₹180</small>
                        </div>
                        <div class="meal-card" onclick="addFood('Standard Breakfast')">
                            <img src="https://images.unsplash.com/photo-1533089860892-a7c6f0a88666?auto=format&fit=crop&w=400" alt="Breakfast">
                            <b>Breakfast</b><br><small>₹120</small>
                        </div>
                </div></div>
            </section>

            <section id="history-module" class="view">
                <button class="btn-back" onclick="navigate('booking-module')"><i class="fa fa-arrow-left"></i> Dashboard</button>
                <div class="glass-card"><h3>Recent Bookings</h3><div id="histBody" style="margin-top:15px;"><p style="color:#94a3b8; text-align:center;">No previous bookings found.</p></div></div>
            </section>

            <section id="settings-module" class="view">
                <button class="btn-back" onclick="navigate('booking-module')"><i class="fa fa-arrow-left"></i> Dashboard</button>
                <div class="glass-card">
                    <h3>Display & Personalization</h3>
                    <div class="setting-row">
                        <div><b>Dark Mode</b><br><small>High contrast dark background</small></div>
                        <label class="switch"><input type="checkbox" onchange="document.body.classList.toggle('dark-theme')"><span class="slider"></span></label>
                    </div>
                    <div class="setting-row">
                        <div><b>Accessibility Font</b><br><small>Increase system text size</small></div>
                        <label class="switch"><input type="checkbox" onchange="alert('Font size adjusted')"><span class="slider"></span></label>
                    </div>
                    <div class="setting-row">
                        <div><b>System Language</b><br><small>Preferred interface language</small></div>
                        <select style="width:140px; font-size:12px;"><option>English (US)</option><option>Hindi</option><option>Spanish</option></select>
                    </div>
                </div>
                <div class="glass-card">
                    <h3>Account & Security</h3>
                    <div class="setting-row">
                        <div><b>Incognito Booking</b><br><small>Don't save history for this session</small></div>
                        <label class="switch"><input type="checkbox" onchange="alert('Privacy Mode Activated')"><span class="slider"></span></label>
                    </div>
                    <div class="setting-row">
                        <div><b>Currency</b><br><small>Select payment display</small></div>
                        <select style="width:140px; font-size:12px;"><option>INR (₹)</option><option>USD ($)</option><option>EUR (€)</option></select>
                    </div>
                    <div class="setting-row">
                        <div><b>Email Notifications</b><br><small>Send ticket copy to email</small></div>
                        <label class="switch"><input type="checkbox" checked><span class="slider"></span></label>
                    </div>
                </div>
            </section>
        </div>
    </main>

    <script>
        function setupMinDate() { document.getElementById('jDate').setAttribute('min', new Date().toISOString().split('T')[0]); }
        let state = { train: '', seats: [], passengerName: 'Aman Sharma', passengerEmail: '', price: 0, date: '', src: 'Delhi', dest: 'Mumbai' };

        function updateUserProfile(name) {
            const displayName = name.trim() || "Aman Sharma";
            document.getElementById('userDisplay').innerText = displayName;
            const initials = displayName.split(" ").map(n => n[0]).join("").toUpperCase().substring(0, 2);
            document.getElementById('userInitial').innerText = initials || "AS";
            state.passengerName = displayName;
        }

        function goBack(targetId, stepNum) {
            document.querySelectorAll('#booking-module .view').forEach(v => v.classList.remove('active'));
            document.getElementById(targetId).classList.add('active');
            for(let i = 5; i > stepNum; i--) { document.getElementById('step' + i).classList.remove('active'); }
        }

        function navigate(moduleID) {
            if(moduleID === 'booking-module') {
                document.querySelectorAll('#booking-module .view').forEach(v => v.classList.remove('active'));
                document.getElementById('bk-search').classList.add('active');
                for(let i=2; i<=5; i++) document.getElementById('step'+i).classList.remove('active');
            }
            document.querySelectorAll('.nav-item').forEach(i => i.classList.remove('active'));
            document.querySelectorAll('section.view').forEach(s => s.classList.remove('active'));
            document.getElementById(moduleID).classList.add('active');
            document.getElementById('headerTitle').innerText = moduleID.replace('-module', '').toUpperCase().replace('-', ' ');
            
            if(moduleID === 'status-module') {
                document.getElementById('trackSrc').innerText = document.getElementById('src').value || "Delhi";
                document.getElementById('trackDest').innerText = document.getElementById('dest').value || "Mumbai";
            }
            const navItems = document.querySelectorAll('.nav-item');
            navItems.forEach(item => { if(item.innerText.toLowerCase().includes(moduleID.split('-')[0].replace('book', 'ticket'))) item.classList.add('active'); });
        }

        function searchTrains() {
            state.date = document.getElementById('jDate').value;
            state.src = document.getElementById('src').value;
            state.dest = document.getElementById('dest').value;
            if(!state.date) return alert("Select Date");
            document.getElementById('globalLoader').style.display = 'flex';
            setTimeout(() => {
                document.getElementById('globalLoader').style.display = 'none';
                document.querySelectorAll('#booking-module .view').forEach(v => v.classList.remove('active'));
                document.getElementById('bk-results').classList.add('active');
                document.getElementById('step2').classList.add('active');
            }, 800);
        }

        function selectTrain(cls, price) {
            state.price = price; state.train = "Rajdhani Exp (12952)";
            document.querySelectorAll('#booking-module .view').forEach(v => v.classList.remove('active'));
            document.getElementById('bk-berths').classList.add('active');
            document.getElementById('step3').classList.add('active');
            initCoachMap();
        }

        function initCoachMap() {
            const container = document.getElementById('coachMap'); container.innerHTML = '';
            for(let i=1; i<=6; i++) {
                const group = document.createElement('div');
                group.className = 'berth-group';
                group.innerHTML = `<div class="berth" onclick="toggleBerth(this, '${i}L')">${i}L</div><div class="berth booked">${i}M</div><div class="berth" onclick="toggleBerth(this, '${i}U')">${i}U</div>`;
                container.appendChild(group);
            }
        }

        function toggleBerth(el, id) {
            el.classList.toggle('selected');
            if(el.classList.contains('selected')) state.seats.push(id);
            else state.seats = state.seats.filter(s => s !== id);
            document.getElementById('selBerths').innerText = state.seats.join(', ') || 'None';
            document.getElementById('totalFare').innerText = '₹' + (state.seats.length * state.price);
            document.getElementById('berthContinue').disabled = state.seats.length === 0;
        }

        function toCheckout() {
            state.passengerEmail = document.getElementById('passEmail').value;
            if(!state.passengerName || !state.passengerEmail) return alert("Enter Passenger Details");
            document.querySelectorAll('#booking-module .view').forEach(v => v.classList.remove('active'));
            document.getElementById('bk-pay').classList.add('active');
            document.getElementById('step4').classList.add('active');
            document.getElementById('invoiceContent').innerHTML = `<h4>Summary for ${state.passengerName}</h4><p>Route: ${state.src} to ${state.dest}</p><p>Base Fare: ₹${state.seats.length * state.price}</p>`;
        }

        function runPayment() {
            document.getElementById('globalLoader').style.display = 'flex';
            setTimeout(() => {
                document.getElementById('globalLoader').style.display = 'none';
                document.querySelectorAll('#booking-module .view').forEach(v => v.classList.remove('active'));
                document.getElementById('bk-ticket').classList.add('active');
                document.getElementById('step5').classList.add('active');
                saveToHistory();
            }, 1500);
        }

        function saveToHistory() {
            const pnr = "PNR-" + Math.floor(Math.random()*900000 + 100000);
            state.pnr = pnr;
            const historyItem = `<div class="glass-card" style="margin-bottom:10px;"><div style="display:flex; justify-content:space-between; align-items:center;"><div><b>${state.train}</b><br><small>${state.date} | PNR: ${pnr}</small></div><div style="text-align:right;"><small>${state.passengerName}</small><br><b>${state.seats.join(', ')}</b></div></div></div>`;
            const histBody = document.getElementById('histBody');
            if(histBody.innerText.includes("No previous bookings")) histBody.innerHTML = '';
            histBody.innerHTML = historyItem + histBody.innerHTML;
        }

        function showTicketUI() {
            document.getElementById('ticketVisual').style.display = 'block';
            document.getElementById('t_pnr').innerText = state.pnr;
            document.getElementById('t_date').innerText = state.date;
            document.getElementById('t_train').innerText = state.train;
            document.getElementById('t_route').innerText = state.src + " to " + state.dest;
            document.getElementById('t_passName').innerText = state.passengerName;
            document.getElementById('t_passEmail').innerText = state.passengerEmail;
            document.getElementById('t_seats').innerText = state.seats.join(', ');
        }

        function downloadTicket() {
            const ticketData = `
RAILNEXUS E-TICKET
-------------------------
PNR: ${state.pnr}
Train: ${state.train}
Date: ${state.date}
Route: ${state.src} to ${state.dest}
Passenger: ${state.passengerName}
Seats: ${state.seats.join(', ')}
Total Fare: ₹${state.seats.length * state.price}
-------------------------
Thank you for choosing RailNexus!
            `;
            const blob = new Blob([ticketData], { type: 'text/plain' });
            const url = window.URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `Ticket_${state.pnr}.txt`;
            a.click();
            window.URL.revokeObjectURL(url);
        }

        function addFood(itemName) { alert(itemName + " was added to your seat for " + state.passengerName + "!"); }
    </script>
</body>
</html>
