<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>busapplication</title>
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --accent: #D84E55;
            --accent-soft: rgba(216, 78, 85, 0.1);
            --sidebar-bg: #0F172A;
            --bg-main: #F8FAFC;
            --white: #FFFFFF;
            --text-dark: #1E293B;
            --text-gray: #64748B;
            --border-color: #E2E8F0;
            --success: #10B981;
            --shadow-sm: 0 2px 4px rgba(0,0,0,0.05);
            --shadow-lg: 0 10px 25px -5px rgba(0,0,0,0.1);
            --radius-lg: 16px;
        }

        * { box-sizing: border-box; margin: 0; padding: 0; font-family: 'Plus Jakarta Sans', sans-serif; }
        body { background: var(--bg-main); display: flex; height: 100vh; overflow: hidden; color: var(--text-dark); }

        /* Loader */
        #loader-overlay {
            position: fixed; inset: 0; background: rgba(255,255,255,0.9);
            display: none; place-items: center; z-index: 3000; backdrop-filter: blur(4px);
        }
        .spinner {
            width: 50px; height: 50px; border: 5px solid var(--accent-soft);
            border-top: 5px solid var(--accent); border-radius: 50%;
            animation: spin 1s linear infinite;
        }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }

        /* Sidebar & Layout */
        aside { width: 280px; background: var(--sidebar-bg); color: var(--white); display: flex; flex-direction: column; padding: 35px 25px; transition: all 0.3s ease; z-index: 1000; }
        .brand { display: flex; align-items: center; gap: 15px; margin-bottom: 50px; padding: 0 10px; }
        .brand i { font-size: 30px; color: var(--accent); }
        .brand h1 { font-size: 24px; font-weight: 800; letter-spacing: -1px; }

        .nav-link { display: flex; align-items: center; gap: 14px; padding: 14px 18px; border-radius: 12px; color: #94A3B8; text-decoration: none; margin-bottom: 8px; font-weight: 600; cursor: pointer; transition: 0.2s; }
        .nav-link.active { background: var(--accent); color: var(--white); }

        main { flex-grow: 1; display: flex; flex-direction: column; overflow-y: auto; position: relative; }
        header { height: 80px; background: rgba(255, 255, 255, 0.8); backdrop-filter: blur(10px); border-bottom: 1px solid var(--border-color); display: flex; align-items: center; justify-content: space-between; padding: 0 45px; position: sticky; top: 0; z-index: 900; }

        /* Modules & Cards */
        .module { display: none; padding: 40px 45px; max-width: 1250px; margin: 0 auto; width: 100%; animation: slideUp 0.4s ease-out; }
        .module.active { display: block; }
        @keyframes slideUp { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }
        .card { background: var(--white); border-radius: var(--radius-lg); border: 1px solid var(--border-color); padding: 35px; margin-bottom: 30px; box-shadow: var(--shadow-sm); }
        .section-title { font-size: 22px; font-weight: 800; margin-bottom: 25px; display: flex; align-items: center; gap: 10px; }

        /* Stepper */
        .stepper { display: flex; gap: 10px; margin-bottom: 40px; }
        .step { flex: 1; height: 6px; background: var(--border-color); border-radius: 10px; position: relative; }
        .step.active { background: var(--accent); }
        .step.active::after { content: attr(data-label); position: absolute; top: 15px; left: 0; font-size: 11px; font-weight: 800; color: var(--accent); text-transform: uppercase; }

        /* Forms */
        .grid-forms { display: grid; grid-template-columns: repeat(3, 1fr); gap: 25px; }
        .input-wrap { display: flex; flex-direction: column; gap: 8px; }
        .input-wrap label { font-size: 11px; font-weight: 700; color: var(--text-gray); text-transform: uppercase; }
        .input-wrap input, select { padding: 14px; border: 1px solid var(--border-color); border-radius: 12px; }

        .btn-action { background: var(--accent); color: var(--white); border: none; padding: 16px 32px; border-radius: 14px; font-weight: 700; cursor: pointer; transition: 0.3s; display: inline-flex; align-items: center; gap: 12px; justify-content: center; }
        .btn-action:disabled { opacity: 0.5; cursor: not-allowed; }

        /* Bus List */
        .bus-row { display: grid; grid-template-columns: 2fr 1fr 1fr 1fr 1.2fr; align-items: center; padding: 25px; background: var(--white); border-bottom: 1px solid var(--border-color); cursor: pointer; }
        .price { font-size: 20px; font-weight: 800; }

        /* Seats */
        .seat-view { display: grid; grid-template-columns: 1.2fr 1fr; gap: 30px; }
        .bus-chassis { background: #E2E8F0; padding: 30px; border-radius: 30px; border: 4px solid #CBD5E1; }
        .seats-grid { display: grid; grid-template-columns: repeat(4, 1fr); gap: 10px; }
        .seat { height: 40px; background: white; border-radius: 6px; cursor: pointer; display: grid; place-items: center; font-weight: 700; border: 1px solid #ccc; }
        .seat.selected { background: var(--accent); color: white; border-color: var(--accent); }
        .seat.taken { background: #cbd5e1; cursor: not-allowed; border: none; }
        .aisle { grid-column: 3; }

        /* Payment Options */
        .pay-option { border: 2px solid var(--border-color); padding: 20px; border-radius: 16px; cursor: pointer; transition: 0.2s; display: flex; align-items: center; gap: 15px; margin-bottom: 15px; }
        .pay-option:hover { border-color: var(--accent); background: var(--accent-soft); }
        .pay-option i { font-size: 24px; color: var(--accent); }

        /* Modal / Ticket */
        .modal { position: fixed; inset: 0; background: rgba(0,0,0,0.7); display: none; place-items: center; z-index: 4000; backdrop-filter: blur(10px); }
        .ticket-box { background: white; border-radius: 24px; width: 450px; overflow: hidden; animation: pop 0.3s cubic-bezier(0.34, 1.56, 0.64, 1); }
        @keyframes pop { from { transform: scale(0.8); opacity: 0; } to { transform: scale(1); opacity: 1; } }

        @media print {
            aside, header, .btn-action, .stepper { display: none !important; }
            .modal { display: block !important; position: static; background: none; }
            .ticket-box { border: 1px solid #eee; width: 100%; box-shadow: none; }
        }
    </style>
</head>
<body>



    <div id="loader-overlay">
        <div style="text-align: center;">
            <div class="spinner"></div>
            <p id="loader-text" style="font-weight: 700;">Processing...</p>
        </div>
    </div>

    <aside>
        <div class="brand"><img src="https://lh3.googleusercontent.com/rd-gg/AMW1TPpF9p83rvEUZCeICWbzlK4XSteekRIVSWUX8Dyj0LWxS3QLXwJC8btWaJyC7pVC4uVEneminiTAqCE2D16QnsUdNo3LpZn4RaW9-gyBOPosdWtXnoQ5gb6MW0z3ca-A7roKELbl2HQ3u5azeN0VkIwCUkfADB8K8yPgAxMu9rfd5aUt2iAW1T0GhhzZSE9u8Tga-nKnhu7QlCalTsjO9s6HI6y6M0-PoReqWzmQUOB413eszf4iqrTzK-v8zDn_zQH53JUSLJd_qcD-zHXUAcO9R-2Ynl6bPo3OSUx40psuhCn1os0Y5vhtSPofETGDQjMsC10eOLCXDpQE-uKNP56kJYXK0SNiUHlkj4Ft1-wp5-Azb16JuZX2twmoe22CgjbSNmMpXfTjEMLOzTrRsdhlDkTgZzQPUleTkQIqiy-wBIou1CafFOrpaVxa_uQK3RQg0TVs6xYCH69FY1RwRve0oSi9rfGlDcs33rwLMCLjcbY5Y7R8hI1BrFVJDbkM_uar3CI77qM4a1Dk4QYgjv3gdIoPRy87EjkPXbTYcUa-cD3Jg4kipILZlLpvkpQj8loC-ZeaC9HUHzIYO3PRiE_PaImlhohxKcYYLuPSAF9YglSlYMZdzfmr_WHi_4UtP7taKt_YmrWU3xC4S9Q4qr1yVbLP_ZHEaTT4V6Gh-pd-IsRqRGKfbjnozXhDp7zccSvremvj1qk6qdonEu6qoz7DZz7K-jeHKdnpM-nLe5PXFePe7ijbA8w-_4SIqvzx3n53W0zVZhxOS_lg7lP_tgZB9NKoUDd6hC-G6f9yEPnNM3LvOVUC0fww84CKOxGUPXfxm2iXL4Q9iAGowLJ-_pAyMS2uG7bgepDGgrXW6CT-sDQ_SFw6u9QopPCIwEygdLgBstiXe9WJCff0EI1P_iaFTwpqN3uQupEVhghv7KmtbnlVZejhUv7gkLpFQ3OSTGROZyU30HV-aRmZyo18rjk8cPTCuC-fGe-d8UXjc7Atpzu_xsB3hxoVH7Uvnk2zygXCuNApuXqK7YtiO1DF8HFytfWnX6AIXVQxQchvMeXwe7FmXhTHaodFij7xnKBtca-q7ba0nYC0LHx-O00IYoRGwtl04EIIHtJ-ehNvJSjJwEtOizmxQA0Fq7iA6BM2REtj674l20B653jKjf46uXitRcTiXTb2j-Patm-eiuRP8_V2Szs-bllEl1fhpMNxvila_frygjJGqTIAI9o5_IkRHJT3nHl81Q4ZenAdnBEfDkvq7KtTAIpxpvwa0GGRyUr9Mgcg-5mhMxFcpRethBCMIul-IV6iNJmoGxBD6suKF6r8lq4BjVpW5P2PQyh-cnQc61mORqHs1CB8nUh-Z3Po_IHI88wlBfZEUrLymq670KZ0NZIbl9D3a8E=s1024-rj" height="60" width="60"> <h1>DJGST</h1></div>
        <div class="nav-group" style="flex-grow: 1;">
            <div class="nav-link active"><i class="fa fa-plus-circle"></i> New Booking</div>
        </div>
        
    </aside>

    <main>
        <header>
            <h2 id="page-title" style="font-weight: 800;">New Booking</h2>  <div class="user-panel">
                <div style="text-align: right">
                    <p style="font-size: 14px; font-weight: 700;">DJGST</p>
                    <p style="font-size: 11px; color: var(--text-gray);">TRAVELS</p>
                </div>
                <div class="avatar">DT</div>
            </div>
            
        </header>

        <section id="mod-booking" class="module active">
            <div class="stepper">
                <div class="step active" id="st-1" data-label="Passenger"></div>
                <div class="step" id="st-2" data-label="Bus"></div>
                <div class="step" id="st-3" data-label="Seats"></div>
                <div class="step" id="st-4" data-label="Payment"></div>
            </div>

            <div id="step-search" class="bk-stage">
                <div class="card">
                    <h3 class="section-title"><i class="fa fa-user-tag"></i> Passenger & Route</h3>
                    <div class="grid-forms row">
                        <div class="input-wrap"><label class="col-12 col-xs-12 col-xl-6 col-lg-6">Full Name</label><input type="text" id="u-name" placeholder="John Doe"></div>
                        <div class="input-wrap"><label class="col-12 col-xs-12 col-xl-6 col-lg-6">Origin</label><input type="text" id="u-src" value="Hyderabad"></div><br>
                        <div class="input-wrap"><label class="col-12 col-xs-12 col-xl-6 col-lg-6">Destination</label><input type="text" id="u-dest" value="Bangalore"></div>
                    </div>
                    <div class="grid-forms" style="margin-top:20px">
                        <div class="input-wrap"><label>Travel Date</label><input type="date" id="u-date"></div>
                        <div class="input-wrap"><label>Bus Type</label>
                            <select id="u-type">
                                <option>AC Sleeper (Premium)</option>
                                <option>Luxury Scania AC</option>
                            </select>
                        </div>
                    </div>
                    <button class="btn-action" style="margin-top:30px" onclick="showBuses()">Search Buses <i class="fa fa-arrow-right"></i></button>
                </div>
            </div>

            <div id="step-buses" class="bk-stage" style="display:none">
                <div class="bus-row" onclick="selectBus('Orange Travels', 1250)">
                    <div><span style="font-weight:800">Orange Travels</span><br><small>Verified</small></div>
                    <div>22:00</div><div>8h 15m</div><div class="price">₹1,250</div>
                    <button class="btn-action">Select</button>
                </div>
                <div class="bus-row" style="margin-top:10px" onclick="selectBus('Zingbus Premium', 899)">
                    <div><span style="font-weight:800">Zingbus Premium</span><br><small>Eco-Friendly</small></div>
                    <div>23:30</div><div>9h 00m</div><div class="price">₹899</div>
                    <button class="btn-action">Select</button>
                </div>
            </div>

            <div id="step-seats" class="bk-stage" style="display:none">
                <div class="seat-view">
                    <div class="card"><div class="bus-chassis"><div class="seats-grid" id="seats-container"></div></div></div>
                    <div class="card">
                        <h3 class="section-title">Fare Details</h3>
                        <p id="sum-bus">--</p>
                        <h2 id="sum-total" style="font-size:32px; margin:15px 0">₹0</h2>
                        <button class="btn-action" style="width:100%" id="btn-to-pay" onclick="goToPayment()" disabled>Proceed to Pay</button>
                    </div>
                </div>
            </div>

            <div id="step-pay" class="bk-stage" style="display:none">
                <div class="card" style="max-width: 600px; margin: 0 auto;">
                    <h3 class="section-title"><i class="fa fa-shield-check"></i> Secure Checkout</h3>
                    
                    <div id="pay-methods">
                        <div class="pay-option" onclick="payWith('qr')">
                            <i class="fa fa-qrcode"></i>
                            <div><b>UPI QR Code</b><br><small>Scan and pay with any app</small></div>
                        </div>
                        <div class="pay-option" onclick="payWith('phone')">
                            <i class="fa fa-mobile-screen"></i>
                            <div><b>Mobile Number</b><br><small>Pay via PhonePe / GPay</small></div>
                        </div>
                    </div>

                    <div id="pay-qr" style="display:none; text-align:center">
                        <img src="https://api.qrserver.com/v1/create-qr-code/?size=150x150&data=SWIFTBUS-PAY" style="margin-bottom:15px">
                        <p>Scan to pay <b>₹<span class="final-amt">0</span></b></p>
                        <button class="btn-action" style="margin-top:20px" onclick="finalProcess()">I have Paid</button>
                    </div>

                    <div id="pay-phone" style="display:none; text-align:center">
                        <input type="tel" id="pay-tel" placeholder="Enter Mobile Number" style="padding:15px; width:100%; border-radius:10px; border:1px solid #ccc; margin-bottom:15px">
                        <button class="btn-action" style="width:100%" onclick="finalProcess()">Generate Request</button>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <div class="modal" id="ticket-modal">
        <div class="ticket-box">
            <div style="background:var(--success); color:white; padding:30px; text-align:center">
                <i class="fa fa-check-circle" style="font-size:50px; margin-bottom:10px"></i>
                <h2>Payment Successful</h2>
                <p>PNR: <span id="f-pnr">--</span></p>
            </div>
            <div style="padding:30px">
                <p style="font-size:11px; color:gray; font-weight:700">PASSENGER</p>
                <h3 id="f-name" style="margin-bottom:15px">--</h3>
                <div style="display:grid; grid-template-columns:1fr 1fr; gap:15px; font-size:14px">
                    <div><small>DATE</small><br><b id="f-date"></b></div>
                    <div><small>ROUTE</small><br><b id="f-route"></b></div>
                    <div><small>SEATS</small><br><b id="f-seats"></b></div>
                    <div><small>BUS</small><br><b id="f-bus"></b></div>
                </div>
                <img src="https://api.qrserver.com/v1/create-qr-code/?size=100x100&data=VERIFIED" style="display:block; margin:20px auto 0">
            </div>
            <div style="padding: 0 30px 30px; display:flex; gap:10px">
                <button class="btn-action" style="flex:1" onclick="window.print()">Print</button>
                <button class="btn-action" style="flex:1; background:#334155" onclick="location.reload()">Close</button>
            </div>
        </div>
    </div>

    <script>
        let bookingData = { name:'', type:'', src:'', dest:'', date:'', bus:'', price:0, seats:[] };

        function triggerLoader(text, callback) {
            document.getElementById('loader-text').innerText = text;
            document.getElementById('loader-overlay').style.display = 'grid';
            setTimeout(() => {
                document.getElementById('loader-overlay').style.display = 'none';
                callback();
            }, 1500);
        }

        function showBuses() {
            bookingData.name = document.getElementById('u-name').value;
            bookingData.src = document.getElementById('u-src').value;
            bookingData.dest = document.getElementById('u-dest').value;
            bookingData.date = document.getElementById('u-date').value;
            bookingData.type = document.getElementById('u-type').value;

            if(!bookingData.name || !bookingData.date) return alert("Enter Passenger Details");
            
            triggerLoader("Finding Buses...", () => {
                document.getElementById('step-search').style.display = 'none';
                document.getElementById('step-buses').style.display = 'block';
                document.getElementById('st-2').classList.add('active');
            });
        }

        function selectBus(name, fare) {
            bookingData.bus = name;
            bookingData.price = fare;
            document.getElementById('step-buses').style.display = 'none';
            document.getElementById('step-seats').style.display = 'block';
            document.getElementById('st-3').classList.add('active');
            document.getElementById('sum-bus').innerText = name + " | " + bookingData.type;
            renderSeats();
        }

        function renderSeats() {
            const container = document.getElementById('seats-container');
            container.innerHTML = '';
            for(let i=1; i<=24; i++) {
                if(i%4 === 3) { let a = document.createElement('div'); a.className='aisle'; container.appendChild(a); }
                const s = document.createElement('div');
                s.className = 'seat'; s.innerText = i;
                if([3, 7, 12].includes(i)) s.className += ' taken';
                else s.onclick = () => {
                    s.classList.toggle('selected');
                    const seatNum = parseInt(s.innerText);
                    if(s.classList.contains('selected')) bookingData.seats.push(seatNum);
                    else bookingData.seats = bookingData.seats.filter(x => x !== seatNum);
                    
                    let total = bookingData.seats.length * bookingData.price;
                    document.getElementById('sum-total').innerText = '₹' + total;
                    document.getElementById('btn-to-pay').disabled = bookingData.seats.length === 0;
                    document.querySelectorAll('.final-amt').forEach(e => e.innerText = total);
                };
                container.appendChild(s);
            }
        }

        function goToPayment() {
            triggerLoader("Setting up Secure Gateway...", () => {
                document.getElementById('step-seats').style.display = 'none';
                document.getElementById('step-pay').style.display = 'block';
                document.getElementById('st-4').classList.add('active');
            });
        }

        function payWith(method) {
            document.getElementById('pay-methods').style.display = 'none';
            if(method === 'qr') document.getElementById('pay-qr').style.display = 'block';
            else document.getElementById('pay-phone').style.display = 'block';
        }

        function finalProcess() {
            triggerLoader("Authorizing Payment...", () => {
                const pnr = 'SB-' + Math.floor(100000 + Math.random() * 900000);
                document.getElementById('f-pnr').innerText = pnr;
                document.getElementById('f-name').innerText = bookingData.name.toUpperCase();
                document.getElementById('f-date').innerText = bookingData.date;
                document.getElementById('f-route').innerText = bookingData.src + " to " + bookingData.dest;
                document.getElementById('f-seats').innerText = bookingData.seats.join(', ');
                document.getElementById('f-bus').innerText = bookingData.bus;
                
                document.getElementById('ticket-modal').style.display = 'grid';
            });
        }
    </script>
</body>
</html>
